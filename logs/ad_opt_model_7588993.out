========== Env & Dir ==========
Host: node3103
Start: Tue Dec 30 02:56:48 EST 2025
Submit dir: /orcd/home/002/jositu/ad_opt
PWD: /orcd/home/002/jositu/ad_opt
===============================
Load modules...
Activate environment...
Running prediction_modeling_tweedie.py - clicks prediction
======================================================================
Prediction Modeling for Ad Optimization (No IAI)
======================================================================
Target: clicks
Models: glm, xgb, rf
Embedding method: tfidf
======================================================================
Loading data from data/clean...
  Train: 12063 rows, Test: 4022 rows

Features (66): Match type, Region, day_of_week, is_weekend, month...
Train shape: (12063, 66), Test shape: (4022, 66)

--- Tweedie GLM (scikit-learn) ---
  Tweedie variance power: 1.0
  Best alpha: 0.0
  Train Tweedie D^2 (higher is better): 0.5821
  Test  Tweedie D^2 (higher is better): 0.6020
  Saved pipeline to models/glm_tfidf_clicks.joblib
  Exported weights: weights_tfidf_clicks_numeric.csv, weights_tfidf_clicks_constant.csv, weights_tfidf_clicks_categorical.csv
  [GLM] Global bias: -0.1680
  [GLM] Top decile lift: 4.4382
  [GLM] Conditional MAE: 3.1722

--- XGBoost (Tweedie) ---
  Tweedie variance power: 1.0
  Best params: {'model__colsample_bytree': 0.7, 'model__learning_rate': 0.03, 'model__max_depth': 7, 'model__n_estimators': 300, 'model__subsample': 0.9}
  Train Tweedie D^2 (higher is better): 0.9324
  Test  Tweedie D^2 (higher is better): 0.8522
  Saved model to models/xgb_tweedie_tfidf_clicks.json
  [XGB] Global bias: 0.0592
  [XGB] Top decile lift: 5.3106
  [XGB] Conditional MAE: 1.9108

--- XGBoost RF (Tweedie) ---
  Tweedie variance power: 1.0
  Best params: {'model__colsample_bynode': 0.7, 'model__max_depth': 3, 'model__n_estimators': 300, 'model__subsample': 0.7}
  Train Tweedie D^2 (higher is better): -32806265686.0737
  Test  Tweedie D^2 (higher is better): -47106223648.7018
  Saved model to models/rf_tweedie_tfidf_clicks.json
  [RF] Global bias: 214261251803.4087
  [RF] Top decile lift: 4.4550
  [RF] Conditional MAE: 214261251805.8610

======================================================================
Model Performance Summary (Test Tweedie D^2)
======================================================================
  XGB   : 0.8522 | bias=0.0592 | top-decile lift=5.3106 | cMAE=1.9108
  GLM   : 0.6020 | bias=-0.1680 | top-decile lift=4.4382 | cMAE=3.1722
  RF    : -47106223648.7018 | bias=214261251803.4087 | top-decile lift=4.4550 | cMAE=214261251805.8610

Best model: XGB
======================================================================
======================================================================
Prediction Modeling for Ad Optimization (No IAI)
======================================================================
Target: clicks
Models: glm, xgb, rf
Embedding method: bert
======================================================================
Loading data from data/clean...
  Train: 12063 rows, Test: 4022 rows

Features (66): Match type, Region, day_of_week, is_weekend, month...
Train shape: (12063, 66), Test shape: (4022, 66)

--- Tweedie GLM (scikit-learn) ---
  Tweedie variance power: 1.0
  Best alpha: 0.01
  Train Tweedie D^2 (higher is better): 0.5720
  Test  Tweedie D^2 (higher is better): 0.5910
  Saved pipeline to models/glm_bert_clicks.joblib
  Exported weights: weights_bert_clicks_numeric.csv, weights_bert_clicks_constant.csv, weights_bert_clicks_categorical.csv
  [GLM] Global bias: -0.1464
  [GLM] Top decile lift: 4.5122
  [GLM] Conditional MAE: 3.2021

--- XGBoost (Tweedie) ---
Running prediction_modeling_tweedie.py - conversion value per click prediction
======================================================================
Prediction Modeling for Ad Optimization (No IAI)
======================================================================
Target: epc
Models: glm, xgb, rf
Embedding method: tfidf
======================================================================
Loading data from data/clean...
  Train: 12063 rows, Test: 4022 rows

Features (66): Match type, Region, day_of_week, is_weekend, month...
Train shape: (12063, 66), Test shape: (4022, 66)

--- Tweedie GLM (scikit-learn) ---
  Tweedie variance power: 1.5
  Best alpha: 5.0
  Train Tweedie D^2 (higher is better): 0.2303
  Test  Tweedie D^2 (higher is better): 0.0312
  Saved pipeline to models/glm_tfidf_epc.joblib
  Exported weights: weights_tfidf_epc_numeric.csv, weights_tfidf_epc_constant.csv, weights_tfidf_epc_categorical.csv
  [GLM] Global bias: -16.3845
  [GLM] Top decile lift: 4.2895
  [GLM] Conditional MAE: 1615.8494

--- XGBoost (Tweedie) ---
  Tweedie variance power: 1.5
  Best params: {'model__colsample_bytree': 0.9, 'model__learning_rate': 0.03, 'model__max_depth': 3, 'model__n_estimators': 300, 'model__subsample': 0.7}
  Train Tweedie D^2 (higher is better): 0.5985
  Test  Tweedie D^2 (higher is better): -1.5211
  Saved model to models/xgb_tweedie_tfidf_epc.json
  [XGB] Global bias: -22.9062
  [XGB] Top decile lift: 3.5180
  [XGB] Conditional MAE: 1606.9392

--- XGBoost RF (Tweedie) ---
  Tweedie variance power: 1.5
  Best params: {'model__colsample_bynode': 0.7, 'model__max_depth': 3, 'model__n_estimators': 300, 'model__subsample': 0.9}
  Train Tweedie D^2 (higher is better): 0.2661
  Test  Tweedie D^2 (higher is better): 0.0128
  Saved model to models/rf_tweedie_tfidf_epc.json
  [RF] Global bias: -19.9944
  [RF] Top decile lift: 4.7683
  [RF] Conditional MAE: 1630.4162

======================================================================
Model Performance Summary (Test Tweedie D^2)
======================================================================
  GLM   : 0.0312 | bias=-16.3845 | top-decile lift=4.2895 | cMAE=1615.8494
  RF    : 0.0128 | bias=-19.9944 | top-decile lift=4.7683 | cMAE=1630.4162
  XGB   : -1.5211 | bias=-22.9062 | top-decile lift=3.5180 | cMAE=1606.9392

Best model: GLM
======================================================================
======================================================================
Prediction Modeling for Ad Optimization (No IAI)
======================================================================
Target: epc
Models: glm, xgb, rf
Embedding method: bert
======================================================================
Loading data from data/clean...
  Train: 12063 rows, Test: 4022 rows

Features (66): Match type, Region, day_of_week, is_weekend, month...
Train shape: (12063, 66), Test shape: (4022, 66)

--- Tweedie GLM (scikit-learn) ---
  Tweedie variance power: 1.5
  Best alpha: 2.0
  Train Tweedie D^2 (higher is better): 0.2590
  Test  Tweedie D^2 (higher is better): -0.0187
  Saved pipeline to models/glm_bert_epc.joblib
  Exported weights: weights_bert_epc_numeric.csv, weights_bert_epc_constant.csv, weights_bert_epc_categorical.csv
  [GLM] Global bias: -15.6702
  [GLM] Top decile lift: 4.2062
  [GLM] Conditional MAE: 1599.0024

--- XGBoost (Tweedie) ---
End: Tue Dec 30 03:01:43 EST 2025
