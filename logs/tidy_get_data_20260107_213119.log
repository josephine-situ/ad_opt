[Log] Writing output to logs\tidy_get_data_20260107_213119.log
======================================================================
Data Preparation Pipeline for Ad Optimization
======================================================================
Embedding method: bert
N components: 50
Force reload: False
======================================================================

[Step 1] Load and combine keyword data...
  [Cache] Loading from step1_combined.parquet

[Step 2] Format keyword data...
[Step 2] Formatting keyword data...

[Step 3] Extract date features...
  [Cache] Loading from step3_features.parquet

[Step 4] Filter data by date...
  [Cache] Loading from step4_filtered.parquet

[Step 5] Load GKP data...
[Step 5] Loading Google Keyword Planner data...
  Found GKP file: Saved Keywords Stats 2026-01-07 at 18_01_42.csv
  Loaded 4498 rows from Saved Keywords Stats 2026-01-07 at 18_01_42.csv
  After cleaning: 4496 rows with unique keywords

[Step 5.5] Impute missing data...
[Step 5.5] Imputing missing data...
  Total: Imputed 0 missing values (0.00% of total data)
  Imputed missing values by keyword Origin:
    existing                    0 (  0.00%)  |     0/156  keywords (  0.0%)
[Step 5.5] Imputing missing data...
C:\Users\jsitu\OneDrive\Documents\Courses\Research\ad_opt\utils\data_pipeline.py:395: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df[col].fillna(0, inplace=True)
C:\Users\jsitu\OneDrive\Documents\Courses\Research\ad_opt\utils\data_pipeline.py:398: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df[col].fillna('Missing', inplace=True)

  Imputation Summary:
  -------------------------------------------------------------------------------------
  searches_2024_07                        10.90% numeric (0)               (n=490)
  searches_2024_08                        10.90% numeric (0)               (n=490)
  searches_2024_09                        10.90% numeric (0)               (n=490)
  searches_2024_10                        10.90% numeric (0)               (n=490)
  searches_2024_11                        10.90% numeric (0)               (n=490)
  searches_2024_12                        10.90% numeric (0)               (n=490)
  searches_2025_01                        10.90% numeric (0)               (n=490)
  searches_2025_02                        10.90% numeric (0)               (n=490)
  searches_2025_03                        10.90% numeric (0)               (n=490)
  searches_2025_04                        10.90% numeric (0)               (n=490)
  searches_2025_05                        10.90% numeric (0)               (n=490)
  searches_2025_06                        10.90% numeric (0)               (n=490)
  searches_2025_07                        10.90% numeric (0)               (n=490)
  searches_2025_08                        10.90% numeric (0)               (n=490)
  searches_2025_09                        10.90% numeric (0)               (n=490)
  searches_2025_10                        10.90% numeric (0)               (n=490)
  searches_2025_11                        10.90% numeric (0)               (n=490)
  Competition                             22.64% categorical (Missing)     (n=1018)
  Competition (indexed value)             22.64% numeric (0)               (n=1018)
  Top of page bid (low range)             41.73% numeric (0)               (n=1876)
  Top of page bid (high range)            41.73% numeric (0)               (n=1876)
  -------------------------------------------------------------------------------------
  Total: Imputed 14118 missing values (14.27% of total data)
  Imputed missing values by keyword Origin:
    new                     10056 ( 71.23%)  |   711/832  keywords ( 85.5%)
    existing searches        3805 ( 26.95%)  |  1143/3524 keywords ( 32.4%)
    existing                  257 (  1.82%)  |    22/140  keywords ( 15.7%)

[Step 6] Merge with GKP data...
  [Cache] Loading from step6_merged.parquet

[Step 7] Add BERT embeddings...
  [Cache] Loading from step8_embeddings_bert.parquet

[Step 8] Removing rows with NaN values...
  Data after NaN removal: 38592 rows

[Step 9] Preparing train-test split and saving outputs...
[Step 9] Preparing train-test split...
  Train set: 28944 rows
  Test set: 9648 rows
[Step 10] Saving outputs to data/clean/...
  Saved: data\clean\ad_opt_data_bert.csv
  Saved: data\clean\train_bert.csv
  Saved: data\clean\test_bert.csv
  Saved: data\clean\unique_keyword_embeddings_bert.csv (149 rows)
======================================================================
âœ“ Pipeline completed successfully!
======================================================================
