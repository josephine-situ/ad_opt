========== Env & Dir ==========
Host: node2704
Start: Wed Dec 31 21:44:54 EST 2025
Submit dir: /orcd/home/002/jositu/ad_opt
PWD: /orcd/home/002/jositu/ad_opt
===============================
Load modules...
Activate environment...
Regenerating XGB preprocessors with current sklearn version...
======================================================================
Prediction Modeling for Ad Optimization (No IAI)
======================================================================
Target: epc
Models: xgb
Embedding method: bert
======================================================================
Loading data from data/clean...
  Train: 12063 rows, Test: 4022 rows

Features (66): Match type, Region, day_of_week, is_weekend, month...
Train shape: (12063, 66), Test shape: (4022, 66)

--- XGBoost (Tweedie) ---
  [XGB] Best CV deviance (weighted): 24.565390
  Tweedie variance power: 1.5
  Best params: {'model__colsample_bytree': 1.0, 'model__learning_rate': 0.3, 'model__max_depth': 2, 'model__n_estimators': 10, 'model__subsample': 1.0}
  Train Tweedie D^2 (higher is better): 0.2830
  Test  Tweedie D^2 (higher is better): 0.2811
  [XGB train] mean(y)=24.0246 mean(pred)=17.8125 bias=-6.2121 | wmean(y)=21.2320 wmean(pred)=17.0969 wbias=-4.1351
  [XGB train] quantiles y: min=0 p1=0 med=0 p99=268.6 max=1.628e+04
  [XGB train] quantiles pred: min=0.26 p1=0.4544 med=14.36 p99=69.63 max=152.1
  [XGB test] mean(y)=33.6378 mean(pred)=17.7440 bias=-15.8938 | wmean(y)=17.5387 wmean(pred)=14.8682 wbias=-2.6705
  [XGB test] quantiles y: min=0 p1=0 med=0 p99=226.7 max=1.192e+04
  [XGB test] quantiles pred: min=0.315 p1=0.364 med=14.38 p99=66.81 max=102.8
  Saved model to models/xgb_tweedie_bert_epc.json
  Saved preprocessor to models/xgb_tweedie_bert_epc_preprocess.joblib
  [XGB] Global bias: -2.6705
  [XGB] Top decile lift: 5.4139
  [XGB] Conditional MAE: 212.2268

======================================================================
Model Performance Summary (Test Tweedie D^2)
======================================================================
  XGB   : 0.2811 | bias=-2.6705 | top-decile lift=5.4139 | cMAE=212.2268

Best model: XGB
======================================================================
======================================================================
Prediction Modeling for Ad Optimization (No IAI)
======================================================================
Target: clicks
Models: xgb
Embedding method: bert
======================================================================
Loading data from data/clean...
  Train: 12063 rows, Test: 4022 rows

Features (66): Match type, Region, day_of_week, is_weekend, month...
Train shape: (12063, 66), Test shape: (4022, 66)

--- XGBoost (Tweedie) ---
  Tweedie variance power: 1.0
  Best params: {'model__colsample_bytree': 1.0, 'model__learning_rate': 0.1, 'model__max_depth': 4, 'model__n_estimators': 20, 'model__subsample': 1.0}
  Train Tweedie D^2 (higher is better): 0.7376
  Test  Tweedie D^2 (higher is better): 0.7238
  [XGB train] mean(y)=4.1233 mean(pred)=4.2042 bias=0.0810
  [XGB train] quantiles y: min=1 p1=1 med=2 p99=40 max=333
  [XGB train] quantiles pred: min=1.472 p1=1.648 med=2.322 p99=22.49 max=193.2
  [XGB test] mean(y)=4.4368 mean(pred)=4.5447 bias=0.1079
  [XGB test] quantiles y: min=1 p1=1 med=2 p99=54 max=235
  [XGB test] quantiles pred: min=1.519 p1=1.652 med=2.311 p99=22.49 max=193.2
  Saved model to models/xgb_tweedie_bert_clicks.json
  Saved preprocessor to models/xgb_tweedie_bert_clicks_preprocess.joblib
  [XGB] Global bias: 0.1079
  [XGB] Top decile lift: 4.9759
  [XGB] Conditional MAE: 2.5596

======================================================================
Model Performance Summary (Test Tweedie D^2)
======================================================================
  XGB   : 0.7238 | bias=0.1079 | top-decile lift=4.9759 | cMAE=2.5596

Best model: XGB
======================================================================
End: Wed Dec 31 21:45:22 EST 2025
